
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "examples/42_model_bsdc_seg.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_examples_42_model_bsdc_seg.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_examples_42_model_bsdc_seg.py:


BSDC-SEG demo: segment-sparse codes, bundling, and segment-wise search
=======================================================================

Run (optional):
  python -m examples.bsdc_seg_demo

.. GENERATED FROM PYTHON SOURCE LINES 8-45

.. code-block:: Python
   :lineno-start: 9


    from holovec.backends import get_backend
    from holovec.models.bsdc_seg import BSDCSEGModel
    from holovec.utils.search import segment_pattern, find_by_segment_pattern


    def main():
        backend = get_backend('numpy')
        D, S = 80, 8
        model = BSDCSEGModel(dimension=D, segments=S, backend=backend, seed=0)
        space = model.space

        # Build a small codebook
        codebook = {
            f"item{i}": space.random(seed=10 + i) for i in range(10)
        }

        # Bundle a couple of items
        bundle = model.bundle([codebook['item1'], codebook['item2'], codebook['item3']])
        print("Bundled vector pattern (first 3 segments):", segment_pattern(bundle, space)[:3])

        # Query by segment pattern (wildcards allowed via None)
        # e.g., find items where segments 0 and 1 match a target vector
        target = codebook['item1']
        pat = segment_pattern(target, space)
        query_pattern = [pat[0], pat[1]] + [None] * (S - 2)

        exact = find_by_segment_pattern(codebook, space, query_pattern, match_mode='exact')
        print("Exact matches on first 2 segments:", [lbl for lbl, _ in exact])

        frac = find_by_segment_pattern(codebook, space, query_pattern, match_mode='fraction', min_fraction=0.5)
        print("Fraction >= 0.5 on specified segments:", frac)


    if __name__ == "__main__":
        main()



.. _sphx_glr_download_examples_42_model_bsdc_seg.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: 42_model_bsdc_seg.ipynb <42_model_bsdc_seg.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: 42_model_bsdc_seg.py <42_model_bsdc_seg.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: 42_model_bsdc_seg.zip <42_model_bsdc_seg.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
